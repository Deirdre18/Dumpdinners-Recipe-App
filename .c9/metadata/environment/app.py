{"filter":false,"title":"app.py","tooltip":"/app.py","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":158,"column":4},"end":{"row":158,"column":5},"action":"insert","lines":["s"],"id":214},{"start":{"row":158,"column":5},"end":{"row":158,"column":6},"action":"insert","lines":["h"]},{"start":{"row":158,"column":6},"end":{"row":158,"column":7},"action":"insert","lines":["a"]},{"start":{"row":158,"column":7},"end":{"row":158,"column":8},"action":"insert","lines":["r"]},{"start":{"row":158,"column":8},"end":{"row":158,"column":9},"action":"insert","lines":["e"]},{"start":{"row":158,"column":9},"end":{"row":158,"column":10},"action":"insert","lines":["1"]}],[{"start":{"row":163,"column":28},"end":{"row":163,"column":29},"action":"remove","lines":["k"],"id":215},{"start":{"row":163,"column":27},"end":{"row":163,"column":28},"action":"remove","lines":["o"]},{"start":{"row":163,"column":26},"end":{"row":163,"column":27},"action":"remove","lines":["o"]},{"start":{"row":163,"column":25},"end":{"row":163,"column":26},"action":"remove","lines":["b"]},{"start":{"row":163,"column":24},"end":{"row":163,"column":25},"action":"remove","lines":["e"]},{"start":{"row":163,"column":23},"end":{"row":163,"column":24},"action":"remove","lines":["c"]},{"start":{"row":163,"column":22},"end":{"row":163,"column":23},"action":"remove","lines":["a"]},{"start":{"row":163,"column":21},"end":{"row":163,"column":22},"action":"remove","lines":["f"]}],[{"start":{"row":163,"column":21},"end":{"row":163,"column":22},"action":"insert","lines":["s"],"id":216},{"start":{"row":163,"column":22},"end":{"row":163,"column":23},"action":"insert","lines":["h"]},{"start":{"row":163,"column":23},"end":{"row":163,"column":24},"action":"insert","lines":["a"]},{"start":{"row":163,"column":24},"end":{"row":163,"column":25},"action":"insert","lines":["r"]},{"start":{"row":163,"column":25},"end":{"row":163,"column":26},"action":"insert","lines":["e"]},{"start":{"row":163,"column":26},"end":{"row":163,"column":27},"action":"insert","lines":["1"]}],[{"start":{"row":163,"column":26},"end":{"row":163,"column":27},"action":"insert","lines":["s"],"id":217}],[{"start":{"row":158,"column":9},"end":{"row":158,"column":10},"action":"insert","lines":["s"],"id":218}],[{"start":{"row":157,"column":18},"end":{"row":157,"column":19},"action":"insert","lines":["s"],"id":219}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"insert","lines":[","],"id":220}],[{"start":{"row":95,"column":18},"end":{"row":96,"column":0},"action":"insert","lines":["",""],"id":221},{"start":{"row":96,"column":0},"end":{"row":96,"column":8},"action":"insert","lines":["        "]},{"start":{"row":96,"column":8},"end":{"row":96,"column":9},"action":"insert","lines":["S"]}],[{"start":{"row":96,"column":8},"end":{"row":96,"column":9},"action":"remove","lines":["S"],"id":222}],[{"start":{"row":96,"column":8},"end":{"row":96,"column":10},"action":"insert","lines":["''"],"id":223}],[{"start":{"row":96,"column":9},"end":{"row":96,"column":10},"action":"insert","lines":["S"],"id":224},{"start":{"row":96,"column":10},"end":{"row":96,"column":11},"action":"insert","lines":["H"]},{"start":{"row":96,"column":11},"end":{"row":96,"column":12},"action":"insert","lines":["A"]},{"start":{"row":96,"column":12},"end":{"row":96,"column":13},"action":"insert","lines":["R"]},{"start":{"row":96,"column":13},"end":{"row":96,"column":14},"action":"insert","lines":["E"]}],[{"start":{"row":96,"column":13},"end":{"row":96,"column":14},"action":"remove","lines":["E"],"id":225},{"start":{"row":96,"column":12},"end":{"row":96,"column":13},"action":"remove","lines":["R"]},{"start":{"row":96,"column":11},"end":{"row":96,"column":12},"action":"remove","lines":["A"]},{"start":{"row":96,"column":10},"end":{"row":96,"column":11},"action":"remove","lines":["H"]},{"start":{"row":96,"column":9},"end":{"row":96,"column":10},"action":"remove","lines":["S"]}],[{"start":{"row":96,"column":9},"end":{"row":96,"column":10},"action":"insert","lines":["s"],"id":226},{"start":{"row":96,"column":10},"end":{"row":96,"column":11},"action":"insert","lines":["h"]},{"start":{"row":96,"column":11},"end":{"row":96,"column":12},"action":"insert","lines":["a"]},{"start":{"row":96,"column":12},"end":{"row":96,"column":13},"action":"insert","lines":["r"]},{"start":{"row":96,"column":13},"end":{"row":96,"column":14},"action":"insert","lines":["e"]},{"start":{"row":96,"column":14},"end":{"row":96,"column":15},"action":"insert","lines":["s"]},{"start":{"row":96,"column":15},"end":{"row":96,"column":16},"action":"insert","lines":["1"]}],[{"start":{"row":96,"column":17},"end":{"row":96,"column":18},"action":"insert","lines":["1"],"id":227}],[{"start":{"row":97,"column":9},"end":{"row":97,"column":10},"action":"insert","lines":[":"],"id":228}],[{"start":{"row":97,"column":9},"end":{"row":97,"column":10},"action":"remove","lines":[":"],"id":229}],[{"start":{"row":96,"column":17},"end":{"row":96,"column":18},"action":"insert","lines":[":"],"id":230}],[{"start":{"row":172,"column":0},"end":{"row":186,"column":3},"action":"insert","lines":["@app.route('/shares1/<recipe_id>')","def shares1 (recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'shares1': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes1'))","","   "],"id":231}],[{"start":{"row":172,"column":19},"end":{"row":172,"column":20},"action":"remove","lines":["1"],"id":232}],[{"start":{"row":172,"column":19},"end":{"row":172,"column":20},"action":"insert","lines":["2"],"id":233}],[{"start":{"row":178,"column":27},"end":{"row":178,"column":28},"action":"remove","lines":["1"],"id":234}],[{"start":{"row":178,"column":27},"end":{"row":178,"column":28},"action":"insert","lines":["2"],"id":235}],[{"start":{"row":173,"column":10},"end":{"row":173,"column":11},"action":"remove","lines":["1"],"id":236}],[{"start":{"row":173,"column":10},"end":{"row":173,"column":11},"action":"insert","lines":["2"],"id":237}],[{"start":{"row":184,"column":43},"end":{"row":185,"column":0},"action":"insert","lines":["",""],"id":238},{"start":{"row":185,"column":0},"end":{"row":185,"column":4},"action":"insert","lines":["    "]},{"start":{"row":185,"column":4},"end":{"row":186,"column":0},"action":"insert","lines":["",""]},{"start":{"row":186,"column":0},"end":{"row":186,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":186,"column":4},"end":{"row":198,"column":43},"action":"insert","lines":["@app.route('/shares2/<recipe_id>')","def shares2 (recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'shares2': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes1'))"],"id":239}],[{"start":{"row":186,"column":0},"end":{"row":186,"column":4},"action":"remove","lines":["    "],"id":240},{"start":{"row":185,"column":4},"end":{"row":186,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":185,"column":4},"end":{"row":186,"column":0},"action":"insert","lines":["",""],"id":241},{"start":{"row":186,"column":0},"end":{"row":186,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":186,"column":0},"end":{"row":186,"column":4},"action":"remove","lines":["    "],"id":242}],[{"start":{"row":198,"column":29},"end":{"row":198,"column":40},"action":"remove","lines":["allrecipes1"],"id":243},{"start":{"row":198,"column":29},"end":{"row":198,"column":65},"action":"insert","lines":["https://twitter.com/intent/tweet?..."]}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":29},"action":"remove","lines":["'"],"id":244}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":29},"action":"insert","lines":["\""],"id":245}],[{"start":{"row":198,"column":65},"end":{"row":198,"column":66},"action":"remove","lines":["'"],"id":246}],[{"start":{"row":198,"column":65},"end":{"row":198,"column":66},"action":"insert","lines":["\""],"id":247}],[{"start":{"row":172,"column":0},"end":{"row":172,"column":2},"action":"insert","lines":["# "],"id":248},{"start":{"row":173,"column":0},"end":{"row":173,"column":2},"action":"insert","lines":["# "]},{"start":{"row":175,"column":0},"end":{"row":175,"column":2},"action":"insert","lines":["# "]},{"start":{"row":176,"column":0},"end":{"row":176,"column":2},"action":"insert","lines":["# "]},{"start":{"row":177,"column":0},"end":{"row":177,"column":2},"action":"insert","lines":["# "]},{"start":{"row":178,"column":0},"end":{"row":178,"column":2},"action":"insert","lines":["# "]},{"start":{"row":182,"column":0},"end":{"row":182,"column":2},"action":"insert","lines":["# "]},{"start":{"row":183,"column":0},"end":{"row":183,"column":2},"action":"insert","lines":["# "]},{"start":{"row":184,"column":0},"end":{"row":184,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":198,"column":65},"end":{"row":198,"column":66},"action":"remove","lines":["\""],"id":249},{"start":{"row":198,"column":64},"end":{"row":198,"column":65},"action":"remove","lines":["."]},{"start":{"row":198,"column":63},"end":{"row":198,"column":64},"action":"remove","lines":["."]},{"start":{"row":198,"column":62},"end":{"row":198,"column":63},"action":"remove","lines":["."]},{"start":{"row":198,"column":61},"end":{"row":198,"column":62},"action":"remove","lines":["?"]},{"start":{"row":198,"column":60},"end":{"row":198,"column":61},"action":"remove","lines":["t"]},{"start":{"row":198,"column":59},"end":{"row":198,"column":60},"action":"remove","lines":["e"]},{"start":{"row":198,"column":58},"end":{"row":198,"column":59},"action":"remove","lines":["e"]},{"start":{"row":198,"column":57},"end":{"row":198,"column":58},"action":"remove","lines":["w"]},{"start":{"row":198,"column":56},"end":{"row":198,"column":57},"action":"remove","lines":["t"]},{"start":{"row":198,"column":55},"end":{"row":198,"column":56},"action":"remove","lines":["/"]},{"start":{"row":198,"column":54},"end":{"row":198,"column":55},"action":"remove","lines":["t"]},{"start":{"row":198,"column":53},"end":{"row":198,"column":54},"action":"remove","lines":["n"]},{"start":{"row":198,"column":52},"end":{"row":198,"column":53},"action":"remove","lines":["e"]},{"start":{"row":198,"column":51},"end":{"row":198,"column":52},"action":"remove","lines":["t"]},{"start":{"row":198,"column":50},"end":{"row":198,"column":51},"action":"remove","lines":["n"]},{"start":{"row":198,"column":49},"end":{"row":198,"column":50},"action":"remove","lines":["i"]},{"start":{"row":198,"column":48},"end":{"row":198,"column":49},"action":"remove","lines":["/"]},{"start":{"row":198,"column":47},"end":{"row":198,"column":48},"action":"remove","lines":["m"]},{"start":{"row":198,"column":46},"end":{"row":198,"column":47},"action":"remove","lines":["o"]},{"start":{"row":198,"column":45},"end":{"row":198,"column":46},"action":"remove","lines":["c"]},{"start":{"row":198,"column":44},"end":{"row":198,"column":45},"action":"remove","lines":["."]},{"start":{"row":198,"column":43},"end":{"row":198,"column":44},"action":"remove","lines":["r"]}],[{"start":{"row":198,"column":42},"end":{"row":198,"column":43},"action":"remove","lines":["e"],"id":250},{"start":{"row":198,"column":41},"end":{"row":198,"column":42},"action":"remove","lines":["t"]},{"start":{"row":198,"column":40},"end":{"row":198,"column":41},"action":"remove","lines":["t"]},{"start":{"row":198,"column":39},"end":{"row":198,"column":40},"action":"remove","lines":["i"]},{"start":{"row":198,"column":38},"end":{"row":198,"column":39},"action":"remove","lines":["w"]},{"start":{"row":198,"column":37},"end":{"row":198,"column":38},"action":"remove","lines":["t"]},{"start":{"row":198,"column":36},"end":{"row":198,"column":37},"action":"remove","lines":["/"]},{"start":{"row":198,"column":35},"end":{"row":198,"column":36},"action":"remove","lines":["/"]},{"start":{"row":198,"column":34},"end":{"row":198,"column":35},"action":"remove","lines":[":"]},{"start":{"row":198,"column":33},"end":{"row":198,"column":34},"action":"remove","lines":["s"]},{"start":{"row":198,"column":32},"end":{"row":198,"column":33},"action":"remove","lines":["p"]},{"start":{"row":198,"column":31},"end":{"row":198,"column":32},"action":"remove","lines":["t"]},{"start":{"row":198,"column":30},"end":{"row":198,"column":31},"action":"remove","lines":["t"]}],[{"start":{"row":198,"column":29},"end":{"row":198,"column":30},"action":"remove","lines":["h"],"id":251},{"start":{"row":198,"column":28},"end":{"row":198,"column":29},"action":"remove","lines":["\""]}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":29},"action":"insert","lines":[";"],"id":252}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":29},"action":"remove","lines":[";"],"id":253}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":30},"action":"insert","lines":["''"],"id":254}],[{"start":{"row":198,"column":29},"end":{"row":198,"column":30},"action":"insert","lines":["s"],"id":255},{"start":{"row":198,"column":30},"end":{"row":198,"column":31},"action":"insert","lines":["h"]},{"start":{"row":198,"column":31},"end":{"row":198,"column":32},"action":"insert","lines":["a"]}],[{"start":{"row":198,"column":32},"end":{"row":198,"column":33},"action":"insert","lines":["r"],"id":256},{"start":{"row":198,"column":33},"end":{"row":198,"column":34},"action":"insert","lines":["e"]},{"start":{"row":198,"column":34},"end":{"row":198,"column":35},"action":"insert","lines":["s"]},{"start":{"row":198,"column":35},"end":{"row":198,"column":36},"action":"insert","lines":["2"]}],[{"start":{"row":96,"column":15},"end":{"row":96,"column":16},"action":"remove","lines":["1"],"id":257}],[{"start":{"row":96,"column":15},"end":{"row":96,"column":16},"action":"insert","lines":["2"],"id":258}],[{"start":{"row":96,"column":19},"end":{"row":96,"column":20},"action":"insert","lines":[","],"id":259}],[{"start":{"row":96,"column":20},"end":{"row":97,"column":0},"action":"insert","lines":["",""],"id":260},{"start":{"row":97,"column":0},"end":{"row":97,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":97,"column":8},"end":{"row":97,"column":19},"action":"insert","lines":["'shares2':1"],"id":261}],[{"start":{"row":97,"column":15},"end":{"row":97,"column":16},"action":"remove","lines":["2"],"id":262}],[{"start":{"row":97,"column":15},"end":{"row":97,"column":16},"action":"insert","lines":["1"],"id":263}],[{"start":{"row":96,"column":8},"end":{"row":97,"column":19},"action":"remove","lines":["'shares2':1,","        'shares1':1"],"id":264}],[{"start":{"row":95,"column":17},"end":{"row":95,"column":18},"action":"remove","lines":[","],"id":265}],[{"start":{"row":158,"column":0},"end":{"row":158,"column":2},"action":"insert","lines":["# "],"id":266},{"start":{"row":159,"column":0},"end":{"row":159,"column":2},"action":"insert","lines":["# "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":2},"action":"insert","lines":["# "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":2},"action":"insert","lines":["# "]},{"start":{"row":163,"column":0},"end":{"row":163,"column":2},"action":"insert","lines":["# "]},{"start":{"row":164,"column":0},"end":{"row":164,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":156,"column":0},"end":{"row":156,"column":2},"action":"insert","lines":["# "],"id":267},{"start":{"row":158,"column":0},"end":{"row":158,"column":2},"action":"insert","lines":["# "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":2},"action":"insert","lines":["# "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":2},"action":"insert","lines":["# "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":2},"action":"insert","lines":["# "]},{"start":{"row":163,"column":0},"end":{"row":163,"column":2},"action":"insert","lines":["# "]},{"start":{"row":164,"column":0},"end":{"row":164,"column":2},"action":"insert","lines":["# "]},{"start":{"row":168,"column":0},"end":{"row":168,"column":2},"action":"insert","lines":["# "]},{"start":{"row":169,"column":0},"end":{"row":169,"column":2},"action":"insert","lines":["# "]},{"start":{"row":170,"column":0},"end":{"row":170,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":186,"column":0},"end":{"row":186,"column":2},"action":"insert","lines":["# "],"id":268},{"start":{"row":187,"column":0},"end":{"row":187,"column":2},"action":"insert","lines":["# "]},{"start":{"row":189,"column":0},"end":{"row":189,"column":2},"action":"insert","lines":["# "]},{"start":{"row":190,"column":0},"end":{"row":190,"column":2},"action":"insert","lines":["# "]},{"start":{"row":191,"column":0},"end":{"row":191,"column":2},"action":"insert","lines":["# "]},{"start":{"row":192,"column":0},"end":{"row":192,"column":2},"action":"insert","lines":["# "]},{"start":{"row":196,"column":0},"end":{"row":196,"column":2},"action":"insert","lines":["# "]},{"start":{"row":197,"column":0},"end":{"row":197,"column":2},"action":"insert","lines":["# "]},{"start":{"row":198,"column":0},"end":{"row":198,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":156,"column":0},"end":{"row":199,"column":0},"action":"remove","lines":["# # routing for shares","","# # @app.route('/shares1/<recipe_id>')","# # def shares1 (recipe_id):","   ","# #     \"\"\"Shows full recipe and increments view\"\"\"","# #     mongo.db.recipes.find_one_and_update(","# #         {'_id': ObjectId(recipe_id)},","# #         { '$inc': { 'shares1': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('allrecipes1'))","","# @app.route('/shares2/<recipe_id>')","# def shares2 (recipe_id):","   ","#     \"\"\"Shows full recipe and increments view\"\"\"","#     mongo.db.recipes.find_one_and_update(","#         {'_id': ObjectId(recipe_id)},","#         { '$inc': { 'shares2': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('allrecipes1'))","    ","# @app.route('/shares2/<recipe_id>')","# def shares2 (recipe_id):","   ","#     \"\"\"Shows full recipe and increments view\"\"\"","#     mongo.db.recipes.find_one_and_update(","#         {'_id': ObjectId(recipe_id)},","#         { '$inc': { 'shares2': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('shares2'))",""],"id":269}],[{"start":{"row":155,"column":0},"end":{"row":158,"column":4},"action":"remove","lines":["","","      ","    "],"id":270}],[{"start":{"row":120,"column":34},"end":{"row":121,"column":0},"action":"insert","lines":["",""],"id":271},{"start":{"row":121,"column":0},"end":{"row":121,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":121,"column":12},"end":{"row":121,"column":34},"action":"insert","lines":["{'recipe_name': query}"],"id":272}],[{"start":{"row":121,"column":24},"end":{"row":121,"column":25},"action":"remove","lines":["e"],"id":273},{"start":{"row":121,"column":23},"end":{"row":121,"column":24},"action":"remove","lines":["m"]},{"start":{"row":121,"column":22},"end":{"row":121,"column":23},"action":"remove","lines":["a"]},{"start":{"row":121,"column":21},"end":{"row":121,"column":22},"action":"remove","lines":["n"]},{"start":{"row":121,"column":20},"end":{"row":121,"column":21},"action":"remove","lines":["_"]},{"start":{"row":121,"column":19},"end":{"row":121,"column":20},"action":"remove","lines":["e"]},{"start":{"row":121,"column":18},"end":{"row":121,"column":19},"action":"remove","lines":["p"]},{"start":{"row":121,"column":17},"end":{"row":121,"column":18},"action":"remove","lines":["i"]},{"start":{"row":121,"column":16},"end":{"row":121,"column":17},"action":"remove","lines":["c"]},{"start":{"row":121,"column":15},"end":{"row":121,"column":16},"action":"remove","lines":["e"]}],[{"start":{"row":121,"column":14},"end":{"row":121,"column":15},"action":"remove","lines":["r"],"id":274}],[{"start":{"row":121,"column":14},"end":{"row":121,"column":15},"action":"insert","lines":["c"],"id":275},{"start":{"row":121,"column":15},"end":{"row":121,"column":16},"action":"insert","lines":["a"]},{"start":{"row":121,"column":16},"end":{"row":121,"column":17},"action":"insert","lines":["t"]}],[{"start":{"row":121,"column":17},"end":{"row":121,"column":18},"action":"insert","lines":["e"],"id":276},{"start":{"row":121,"column":18},"end":{"row":121,"column":19},"action":"insert","lines":["g"]},{"start":{"row":121,"column":19},"end":{"row":121,"column":20},"action":"insert","lines":["o"]},{"start":{"row":121,"column":20},"end":{"row":121,"column":21},"action":"insert","lines":["r"]},{"start":{"row":121,"column":21},"end":{"row":121,"column":22},"action":"insert","lines":["y"]},{"start":{"row":121,"column":22},"end":{"row":121,"column":23},"action":"insert","lines":["_"]}],[{"start":{"row":121,"column":23},"end":{"row":121,"column":24},"action":"insert","lines":["n"],"id":277},{"start":{"row":121,"column":24},"end":{"row":121,"column":25},"action":"insert","lines":["a"]},{"start":{"row":121,"column":25},"end":{"row":121,"column":26},"action":"insert","lines":["m"]},{"start":{"row":121,"column":26},"end":{"row":121,"column":27},"action":"insert","lines":["e"]}],[{"start":{"row":120,"column":34},"end":{"row":120,"column":35},"action":"insert","lines":[","],"id":278}],[{"start":{"row":109,"column":0},"end":{"row":109,"column":2},"action":"insert","lines":["# "],"id":279},{"start":{"row":110,"column":0},"end":{"row":110,"column":2},"action":"insert","lines":["# "]},{"start":{"row":111,"column":0},"end":{"row":111,"column":2},"action":"insert","lines":["# "]},{"start":{"row":112,"column":0},"end":{"row":112,"column":2},"action":"insert","lines":["# "]},{"start":{"row":113,"column":0},"end":{"row":113,"column":2},"action":"insert","lines":["# "]},{"start":{"row":114,"column":0},"end":{"row":114,"column":2},"action":"insert","lines":["# "]},{"start":{"row":115,"column":0},"end":{"row":115,"column":2},"action":"insert","lines":["# "]},{"start":{"row":116,"column":0},"end":{"row":116,"column":2},"action":"insert","lines":["# "]},{"start":{"row":117,"column":0},"end":{"row":117,"column":2},"action":"insert","lines":["# "]},{"start":{"row":118,"column":0},"end":{"row":118,"column":2},"action":"insert","lines":["# "]},{"start":{"row":119,"column":0},"end":{"row":119,"column":2},"action":"insert","lines":["# "]},{"start":{"row":120,"column":0},"end":{"row":120,"column":2},"action":"insert","lines":["# "]},{"start":{"row":121,"column":0},"end":{"row":121,"column":2},"action":"insert","lines":["# "]},{"start":{"row":122,"column":0},"end":{"row":122,"column":2},"action":"insert","lines":["# "]},{"start":{"row":123,"column":0},"end":{"row":123,"column":2},"action":"insert","lines":["# "]},{"start":{"row":124,"column":0},"end":{"row":124,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":124,"column":78},"end":{"row":125,"column":0},"action":"insert","lines":["",""],"id":280},{"start":{"row":125,"column":0},"end":{"row":126,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":126,"column":0},"end":{"row":173,"column":0},"action":"insert","lines":["@app.route('/find_recipes', methods=['GET', 'POST'])","def find_recipes():","    \"\"\" Find recipes route from Index page search box and checkboxes \"\"\"","    users = mongo.db.users","    if request.method == 'POST':","        search_text = request.form.get(\"search_text\")","        checkboxes = request.form.getlist(\"check\")","        # Search textbox (if empty, else text) with no checkboxes checked","        if len(checkboxes) == 0:","            if search_text == \"\":","                cursor = mongo.db.recipes.find().sort([(\"like_count\", -1)])","                matching_recipes = [matching_recipe for matching_recipe in cursor]","            else:","                cursor = mongo.db.recipes.find({\"$text\": {\"$search\": search_text}}).sort([(\"like_count\", -1)])","                matching_recipes = [matching_recipe for matching_recipe in cursor]","        # Search textbox (if empty, else text) with one checkbox checked        ","        elif len(checkboxes) == 1:","            if search_text == \"\":","                cursor = mongo.db.recipes.find({checkboxes[0]: True})","                matching_recipes = [matching_recipe for matching_recipe in cursor]","            else:","                cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}]}).sort([(\"like_count\", -1)])","                matching_recipes = [matching_recipe for matching_recipe in cursor]","        # Search textbox (if empty, else text) with two checkboxes checked        ","        elif len(checkboxes) == 2:","            if search_text == \"\":","                cursor = mongo.db.recipes.find({\"$and\": [{checkboxes[0]: True}, {checkboxes[1]: True}]}).sort([(\"like_count\", -1)])","                matching_recipes = [matching_recipe for matching_recipe in cursor]","            else:","                cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}, {checkboxes[1]: True}]}).sort([(\"like_count\", -1)]) ","                matching_recipes = [matching_recipe for matching_recipe in cursor]","        # Search textbox (if empty, else text) with three checkboxes checked        ","        elif len(checkboxes) == 3:","            if search_text == \"\":","                cursor = mongo.db.recipes.find({\"$and\": [{checkboxes[0]: True}, {checkboxes[1]: True}, {checkboxes[2]: True}]}).sort([ (\"like_count\", -1)])","                matching_recipes = [matching_recipe for matching_recipe in cursor]","            else:","                cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}, {checkboxes[1]: True}, {checkboxes[2]: True}]}).sort([(\"like_count\", -1)]) ","                matching_recipes = [matching_recipe for matching_recipe in cursor]","        # To enable the user to edit their recipes from the main search page","        if current_user.is_active:","            loggeduser = current_user.username[\"_id\"]","            the_user = users.find_one({\"_id\": loggeduser})","            return render_template(\"search_results.html\", matching_recipes=matching_recipes, user=the_user)","","        return render_template(\"search_results.html\", matching_recipes=matching_recipes)","",""],"id":281}],[{"start":{"row":171,"column":7},"end":{"row":172,"column":0},"action":"remove","lines":[" return render_template(\"search_results.html\", matching_recipes=matching_recipes)",""],"id":282},{"start":{"row":171,"column":7},"end":{"row":171,"column":79},"action":"insert","lines":["return render_template('search.html', query=orig_query, results=results)"]}],[{"start":{"row":165,"column":7},"end":{"row":170,"column":0},"action":"remove","lines":[" # To enable the user to edit their recipes from the main search page","        if current_user.is_active:","            loggeduser = current_user.username[\"_id\"]","            the_user = users.find_one({\"_id\": loggeduser})","            return render_template(\"search_results.html\", matching_recipes=matching_recipes, user=the_user)",""],"id":283}],[{"start":{"row":166,"column":7},"end":{"row":166,"column":8},"action":"insert","lines":[" "],"id":284}],[{"start":{"row":166,"column":8},"end":{"row":166,"column":12},"action":"insert","lines":["    "],"id":285}],[{"start":{"row":166,"column":12},"end":{"row":166,"column":16},"action":"insert","lines":["    "],"id":286}],[{"start":{"row":129,"column":26},"end":{"row":130,"column":0},"action":"insert","lines":["",""],"id":287},{"start":{"row":130,"column":0},"end":{"row":130,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":130,"column":4},"end":{"row":130,"column":38},"action":"insert","lines":["orig_query = request.args['query']"],"id":288}],[{"start":{"row":129,"column":25},"end":{"row":129,"column":26},"action":"remove","lines":["s"],"id":290},{"start":{"row":129,"column":24},"end":{"row":129,"column":25},"action":"remove","lines":["r"]},{"start":{"row":129,"column":23},"end":{"row":129,"column":24},"action":"remove","lines":["e"]},{"start":{"row":129,"column":22},"end":{"row":129,"column":23},"action":"remove","lines":["s"]},{"start":{"row":129,"column":21},"end":{"row":129,"column":22},"action":"remove","lines":["u"]}],[{"start":{"row":129,"column":21},"end":{"row":129,"column":22},"action":"insert","lines":["r"],"id":291},{"start":{"row":129,"column":22},"end":{"row":129,"column":23},"action":"insert","lines":["e"]},{"start":{"row":129,"column":23},"end":{"row":129,"column":24},"action":"insert","lines":["g"]},{"start":{"row":129,"column":24},"end":{"row":129,"column":25},"action":"insert","lines":["i"]},{"start":{"row":129,"column":25},"end":{"row":129,"column":26},"action":"insert","lines":["s"]},{"start":{"row":129,"column":26},"end":{"row":129,"column":27},"action":"insert","lines":["t"]},{"start":{"row":129,"column":27},"end":{"row":129,"column":28},"action":"insert","lines":["e"]},{"start":{"row":129,"column":28},"end":{"row":129,"column":29},"action":"insert","lines":["r"]}],[{"start":{"row":129,"column":29},"end":{"row":130,"column":0},"action":"insert","lines":["",""],"id":292},{"start":{"row":130,"column":0},"end":{"row":130,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":130,"column":4},"end":{"row":136,"column":11},"action":"insert","lines":["results = mongo.db.recipes.find({","#         '$or': [","#             {'recipe_name': query},","#             {'ingredients': query},","#             {'recipe_name': query},","#             {'category_name': query}","#         ]"],"id":293}],[{"start":{"row":136,"column":11},"end":{"row":137,"column":0},"action":"insert","lines":["",""],"id":294}],[{"start":{"row":137,"column":0},"end":{"row":137,"column":2},"action":"insert","lines":["})"],"id":295}],[{"start":{"row":137,"column":0},"end":{"row":137,"column":4},"action":"insert","lines":["    "],"id":296}],[{"start":{"row":131,"column":0},"end":{"row":131,"column":2},"action":"remove","lines":["# "],"id":297},{"start":{"row":132,"column":0},"end":{"row":132,"column":2},"action":"remove","lines":["# "]},{"start":{"row":133,"column":0},"end":{"row":133,"column":2},"action":"remove","lines":["# "]},{"start":{"row":134,"column":0},"end":{"row":134,"column":2},"action":"remove","lines":["# "]},{"start":{"row":135,"column":0},"end":{"row":135,"column":2},"action":"remove","lines":["# "]},{"start":{"row":136,"column":0},"end":{"row":136,"column":2},"action":"remove","lines":["# "]}],[{"start":{"row":129,"column":29},"end":{"row":130,"column":0},"action":"insert","lines":["",""],"id":298},{"start":{"row":130,"column":0},"end":{"row":130,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":130,"column":4},"end":{"row":130,"column":80},"action":"insert","lines":["query = {'$regex': re.compile('.*{}.*'.format(orig_query)), '$options': 'i'}"],"id":299}],[{"start":{"row":139,"column":3},"end":{"row":139,"column":38},"action":"remove","lines":[" orig_query = request.args['query']"],"id":300}],[{"start":{"row":128,"column":72},"end":{"row":129,"column":0},"action":"insert","lines":["",""],"id":301},{"start":{"row":129,"column":0},"end":{"row":129,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":129,"column":4},"end":{"row":129,"column":39},"action":"insert","lines":[" orig_query = request.args['query']"],"id":302}],[{"start":{"row":129,"column":4},"end":{"row":129,"column":5},"action":"remove","lines":[" "],"id":303}],[{"start":{"row":126,"column":24},"end":{"row":126,"column":25},"action":"remove","lines":["s"],"id":304},{"start":{"row":126,"column":23},"end":{"row":126,"column":24},"action":"remove","lines":["e"]},{"start":{"row":126,"column":22},"end":{"row":126,"column":23},"action":"remove","lines":["p"]},{"start":{"row":126,"column":21},"end":{"row":126,"column":22},"action":"remove","lines":["i"]},{"start":{"row":126,"column":20},"end":{"row":126,"column":21},"action":"remove","lines":["c"]},{"start":{"row":126,"column":19},"end":{"row":126,"column":20},"action":"remove","lines":["e"]},{"start":{"row":126,"column":18},"end":{"row":126,"column":19},"action":"remove","lines":["r"]},{"start":{"row":126,"column":17},"end":{"row":126,"column":18},"action":"remove","lines":["_"]},{"start":{"row":126,"column":16},"end":{"row":126,"column":17},"action":"remove","lines":["d"]},{"start":{"row":126,"column":15},"end":{"row":126,"column":16},"action":"remove","lines":["n"]},{"start":{"row":126,"column":14},"end":{"row":126,"column":15},"action":"remove","lines":["i"]},{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"remove","lines":["f"]}],[{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"insert","lines":["s"],"id":305},{"start":{"row":126,"column":14},"end":{"row":126,"column":15},"action":"insert","lines":["r"]},{"start":{"row":126,"column":15},"end":{"row":126,"column":16},"action":"insert","lines":["s"]},{"start":{"row":126,"column":16},"end":{"row":126,"column":17},"action":"insert","lines":["a"]}],[{"start":{"row":126,"column":16},"end":{"row":126,"column":17},"action":"remove","lines":["a"],"id":306},{"start":{"row":126,"column":15},"end":{"row":126,"column":16},"action":"remove","lines":["s"]},{"start":{"row":126,"column":14},"end":{"row":126,"column":15},"action":"remove","lines":["r"]}],[{"start":{"row":126,"column":14},"end":{"row":126,"column":15},"action":"insert","lines":["e"],"id":307},{"start":{"row":126,"column":15},"end":{"row":126,"column":16},"action":"insert","lines":["a"]},{"start":{"row":126,"column":16},"end":{"row":126,"column":17},"action":"insert","lines":["r"]},{"start":{"row":126,"column":17},"end":{"row":126,"column":18},"action":"insert","lines":["c"]},{"start":{"row":126,"column":18},"end":{"row":126,"column":19},"action":"insert","lines":["h"]}],[{"start":{"row":126,"column":12},"end":{"row":126,"column":13},"action":"remove","lines":["/"],"id":308}],[{"start":{"row":126,"column":12},"end":{"row":126,"column":13},"action":"insert","lines":["/"],"id":309}],[{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"remove","lines":["s"],"id":310}],[{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"insert","lines":["S"],"id":311}],[{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"remove","lines":["S"],"id":312}],[{"start":{"row":126,"column":13},"end":{"row":126,"column":14},"action":"insert","lines":["s"],"id":316}],[{"start":{"row":126,"column":0},"end":{"row":126,"column":2},"action":"insert","lines":["# "],"id":317},{"start":{"row":127,"column":0},"end":{"row":127,"column":2},"action":"insert","lines":["# "]},{"start":{"row":128,"column":0},"end":{"row":128,"column":2},"action":"insert","lines":["# "]},{"start":{"row":129,"column":0},"end":{"row":129,"column":2},"action":"insert","lines":["# "]},{"start":{"row":130,"column":0},"end":{"row":130,"column":2},"action":"insert","lines":["# "]},{"start":{"row":131,"column":0},"end":{"row":131,"column":2},"action":"insert","lines":["# "]},{"start":{"row":132,"column":0},"end":{"row":132,"column":2},"action":"insert","lines":["# "]},{"start":{"row":133,"column":0},"end":{"row":133,"column":2},"action":"insert","lines":["# "]},{"start":{"row":134,"column":0},"end":{"row":134,"column":2},"action":"insert","lines":["# "]},{"start":{"row":135,"column":0},"end":{"row":135,"column":2},"action":"insert","lines":["# "]},{"start":{"row":136,"column":0},"end":{"row":136,"column":2},"action":"insert","lines":["# "]},{"start":{"row":137,"column":0},"end":{"row":137,"column":2},"action":"insert","lines":["# "]},{"start":{"row":138,"column":0},"end":{"row":138,"column":2},"action":"insert","lines":["# "]},{"start":{"row":139,"column":0},"end":{"row":139,"column":2},"action":"insert","lines":["# "]},{"start":{"row":141,"column":0},"end":{"row":141,"column":2},"action":"insert","lines":["# "]},{"start":{"row":142,"column":0},"end":{"row":142,"column":2},"action":"insert","lines":["# "]},{"start":{"row":143,"column":0},"end":{"row":143,"column":2},"action":"insert","lines":["# "]},{"start":{"row":144,"column":0},"end":{"row":144,"column":2},"action":"insert","lines":["# "]},{"start":{"row":145,"column":0},"end":{"row":145,"column":2},"action":"insert","lines":["# "]},{"start":{"row":146,"column":0},"end":{"row":146,"column":2},"action":"insert","lines":["# "]},{"start":{"row":147,"column":0},"end":{"row":147,"column":2},"action":"insert","lines":["# "]},{"start":{"row":148,"column":0},"end":{"row":148,"column":2},"action":"insert","lines":["# "]},{"start":{"row":149,"column":0},"end":{"row":149,"column":2},"action":"insert","lines":["# "]},{"start":{"row":150,"column":0},"end":{"row":150,"column":2},"action":"insert","lines":["# "]},{"start":{"row":151,"column":0},"end":{"row":151,"column":2},"action":"insert","lines":["# "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":2},"action":"insert","lines":["# "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":2},"action":"insert","lines":["# "]},{"start":{"row":154,"column":0},"end":{"row":154,"column":2},"action":"insert","lines":["# "]},{"start":{"row":155,"column":0},"end":{"row":155,"column":2},"action":"insert","lines":["# "]},{"start":{"row":156,"column":0},"end":{"row":156,"column":2},"action":"insert","lines":["# "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":2},"action":"insert","lines":["# "]},{"start":{"row":158,"column":0},"end":{"row":158,"column":2},"action":"insert","lines":["# "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":2},"action":"insert","lines":["# "]},{"start":{"row":160,"column":0},"end":{"row":160,"column":2},"action":"insert","lines":["# "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":2},"action":"insert","lines":["# "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":2},"action":"insert","lines":["# "]},{"start":{"row":163,"column":0},"end":{"row":163,"column":2},"action":"insert","lines":["# "]},{"start":{"row":164,"column":0},"end":{"row":164,"column":2},"action":"insert","lines":["# "]},{"start":{"row":165,"column":0},"end":{"row":165,"column":2},"action":"insert","lines":["# "]},{"start":{"row":166,"column":0},"end":{"row":166,"column":2},"action":"insert","lines":["# "]},{"start":{"row":167,"column":0},"end":{"row":167,"column":2},"action":"insert","lines":["# "]},{"start":{"row":168,"column":0},"end":{"row":168,"column":2},"action":"insert","lines":["# "]},{"start":{"row":169,"column":0},"end":{"row":169,"column":2},"action":"insert","lines":["# "]},{"start":{"row":170,"column":0},"end":{"row":170,"column":2},"action":"insert","lines":["# "]},{"start":{"row":171,"column":0},"end":{"row":171,"column":2},"action":"insert","lines":["# "]},{"start":{"row":172,"column":0},"end":{"row":172,"column":2},"action":"insert","lines":["# "]},{"start":{"row":173,"column":0},"end":{"row":173,"column":2},"action":"insert","lines":["# "]},{"start":{"row":174,"column":0},"end":{"row":174,"column":2},"action":"insert","lines":["# "]},{"start":{"row":175,"column":0},"end":{"row":175,"column":2},"action":"insert","lines":["# "]},{"start":{"row":177,"column":0},"end":{"row":177,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":109,"column":0},"end":{"row":109,"column":2},"action":"remove","lines":["# "],"id":318},{"start":{"row":110,"column":0},"end":{"row":110,"column":2},"action":"remove","lines":["# "]},{"start":{"row":111,"column":0},"end":{"row":111,"column":2},"action":"remove","lines":["# "]},{"start":{"row":112,"column":0},"end":{"row":112,"column":2},"action":"remove","lines":["# "]},{"start":{"row":113,"column":0},"end":{"row":113,"column":2},"action":"remove","lines":["# "]},{"start":{"row":114,"column":0},"end":{"row":114,"column":2},"action":"remove","lines":["# "]},{"start":{"row":115,"column":0},"end":{"row":115,"column":2},"action":"remove","lines":["# "]},{"start":{"row":116,"column":0},"end":{"row":116,"column":2},"action":"remove","lines":["# "]},{"start":{"row":117,"column":0},"end":{"row":117,"column":2},"action":"remove","lines":["# "]},{"start":{"row":118,"column":0},"end":{"row":118,"column":2},"action":"remove","lines":["# "]},{"start":{"row":119,"column":0},"end":{"row":119,"column":2},"action":"remove","lines":["# "]},{"start":{"row":120,"column":0},"end":{"row":120,"column":2},"action":"remove","lines":["# "]},{"start":{"row":121,"column":0},"end":{"row":121,"column":2},"action":"remove","lines":["# "]},{"start":{"row":122,"column":0},"end":{"row":122,"column":2},"action":"remove","lines":["# "]},{"start":{"row":123,"column":0},"end":{"row":123,"column":2},"action":"remove","lines":["# "]},{"start":{"row":124,"column":0},"end":{"row":124,"column":2},"action":"remove","lines":["# "]}],[{"start":{"row":0,"column":0},"end":{"row":263,"column":41},"action":"remove","lines":["import os","import re","from flask import Flask, render_template, redirect, request, url_for, session, flash","import json","from flask_pymongo import PyMongo","import pymongo","from pymongo import MongoClient","from bson.objectid import ObjectId"," ","","from werkzeug.security import generate_password_hash, check_password_hash","","","app = Flask(__name__)","","app.secret_key = \"randomstring123\"","","","","if app.config['DEBUG'] == True:","    from config import dbconfig","    app.config[\"MONGO_DBNAME\"] = 'dumpdinners'","    app.config[\"MONGO_URI\"] = dbconfig()","else:","    app.config['MONGO_URI'] = os.environ.get(\"MONGO_URI\")","    app.config['MONGO_DBNAME'] = os.environ.get(\"MONGO_DBNAME\")","","mongo = PyMongo(app)","","","@app.route('/')","@app.route('/index')","def index():","    \"\"\"Home page the gets 4 recipes from DB that have been viewed the most\"\"\"","    four_recipes = mongo.db.recipes.find().limit(4)","    return render_template('allrecipes1.html', recipes=four_recipes)     ","","@app.route('/allrecipes')","def allrecipes():","    recipes = mongo.db.recipes.find()","    return render_template('allrecipes.html', recipes=recipes)    ","    ","@app.route('/allrecipes1')","def allrecipes1():","    recipes = mongo.db.recipes.find()","    four_recipes = mongo.db.recipes.find().limit(4)","    return render_template('allrecipes1.html', recipes=four_recipes)        ","","@app.route('/add_recipe')","def add_recipe():","    recipes = mongo.db.recipes.find()","    return render_template('addrecipe.html',","        recipes=mongo.db.categories.find())   ","","    ","","@app.route('/insert_recipe', methods=['POST'])","def insert_recipe():","    recipes = mongo.db.recipes","    recipes.insert_one(request.form.to_dict())","    flash (\"Thank you, your recipe has been inserted!\")","    return render_template('recipe.html', recipe=recipe)","   ","         ","    ","    ","@app.route('/edit_recipe/<recipe_id>', methods=['GET', 'POST'])","def edit_recipe(recipe_id):","    \"\"\"Allows logged in user to edit their own recipes\"\"\"","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    all_categories =  mongo.db.categories.find()","    if request.method == 'GET':","        ","        return render_template('editrecipe.html', recipe=recipe_db, categories=all_categories)","   ","","# referred to this article for advice on 'views' - https://stackoverflow.com/questions/5782311/mongodb-inc-embedded-value-syntax","","@app.route('/update_recipe/<recipe_id>', methods=[\"POST\"])","def update_recipe(recipe_id):","    recipes = mongo.db.recipes","    recipes.update( {'_id': ObjectId(recipe_id)},","    {","        '$set': {","            ","        'recipe_name':request.form.get('recipe_name'),","        'ingredients':request.form.get('ingredients'),","        'image': request.form.get('image'),","        'category_name': request.form.get('category_name'),","        'username': request.form.get('username'),","        'methods': request.form.get('methods'),","        'short_description': request.form.get('short_description'),","        'date_added': request.form.get('date_added'),","        'is_vegetarian': request.form.get('is_vegetarian'),","        'views':1,","        'likes':1","        ","        }","    })","    return redirect(url_for('allrecipes'))","    ","","","","@app.route('/delete_recipe/<recipe_id>')","def delete_recipe(recipe_id):","    mongo.db.recipes.remove({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes'))","    ","@app.route('/search')","def search():","    \"\"\"Provides logic for search bar\"\"\"","    orig_query = request.args['query']","    # using regular expression setting option for any case","    query = {'$regex': re.compile('.*{}.*'.format(orig_query)), '$options': 'i'}","    # find instances of the entered word in title, tags or ingredients","    results = mongo.db.recipes.find({","        '$or': [","            {'recipe_name': query},","            {'ingredients': query},","            {'recipe_name': query},","            {'category_name': query}","        ]","    })","    return render_template('search.html', query=orig_query, results=results)","","# @app.route('/search', methods=['GET', 'POST'])","# def find_recipes():","#     \"\"\" Find recipes route from Index page search box and checkboxes \"\"\"","#     orig_query = request.args['query']","#     users = mongo.db.register","#     query = {'$regex': re.compile('.*{}.*'.format(orig_query)), '$options': 'i'}","#     results = mongo.db.recipes.find({","#         '$or': [","#             {'recipe_name': query},","#             {'ingredients': query},","#             {'recipe_name': query},","#             {'category_name': query}","#         ]","#     })","   ","#     if request.method == 'POST':","#         search_text = request.form.get(\"search_text\")","#         checkboxes = request.form.getlist(\"check\")","#         # Search textbox (if empty, else text) with no checkboxes checked","#         if len(checkboxes) == 0:","#             if search_text == \"\":","#                 cursor = mongo.db.recipes.find().sort([(\"like_count\", -1)])","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#             else:","#                 cursor = mongo.db.recipes.find({\"$text\": {\"$search\": search_text}}).sort([(\"like_count\", -1)])","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#         # Search textbox (if empty, else text) with one checkbox checked        ","#         elif len(checkboxes) == 1:","#             if search_text == \"\":","#                 cursor = mongo.db.recipes.find({checkboxes[0]: True})","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#             else:","#                 cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}]}).sort([(\"like_count\", -1)])","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#         # Search textbox (if empty, else text) with two checkboxes checked        ","#         elif len(checkboxes) == 2:","#             if search_text == \"\":","#                 cursor = mongo.db.recipes.find({\"$and\": [{checkboxes[0]: True}, {checkboxes[1]: True}]}).sort([(\"like_count\", -1)])","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#             else:","#                 cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}, {checkboxes[1]: True}]}).sort([(\"like_count\", -1)]) ","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#         # Search textbox (if empty, else text) with three checkboxes checked        ","#         elif len(checkboxes) == 3:","#             if search_text == \"\":","#                 cursor = mongo.db.recipes.find({\"$and\": [{checkboxes[0]: True}, {checkboxes[1]: True}, {checkboxes[2]: True}]}).sort([ (\"like_count\", -1)])","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","#             else:","#                 cursor = mongo.db.recipes.find({\"$and\": [{\"$text\": {\"$search\": search_text}}, {checkboxes[0]: True}, {checkboxes[1]: True}, {checkboxes[2]: True}]}).sort([(\"like_count\", -1)]) ","#                 matching_recipes = [matching_recipe for matching_recipe in cursor]","       ","#                 return render_template('search.html', query=orig_query, results=results)","","","","@app.route('/recipe/<recipe_id>')","def recipe(recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'views': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return render_template('recipe.html', recipe=recipe_db)","","# routing for likes","","@app.route('/likes/<recipe_id>')","def likes(recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'likes': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes1'))","","#Copied routing for login from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","","@app.route('/login', methods=[\"GET\",\"POST\"])","def login():","    if request.method == 'POST':","        login_user = mongo.db.register.find_one({'username': request.form['username']})","        form = request.form","        if login_user:","            if(form[\"password\"] == login_user[\"password\"]): # if password correct","                session['username'] = login_user[\"username\"]","                return redirect(url_for('allrecipes',register_id = login_user[\"_id\"]))","            else: # and if password is not correct","               flash(\"Incorrect password, please try again or register\") ","        else:# if user does not exist","            flash(\"User does not exist\")","            return redirect(url_for('register'))","    return render_template('login.html')            ","    ","    ","#Copied routing for register from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","@app.route('/register', methods=['POST','GET'])","def register():","    if request.method == 'POST':","        register = mongo.db.register","        register_id = register.insert_one(request.form.to_dict())","        # print(register)","        object_id = register_id.inserted_id","        flash(\"Thank you for registering, please login to view more recipes and add your own!\")","        return redirect(url_for('login'))","    return render_template('register.html')","              ","    ",""," ","#Copied routing for allrecipeslist from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","","@app.route('/logout')","def logout():","    \"\"\"Clears session and redirects to home\"\"\"","    ","    session.clear()","    flash (\"Thank you, hope to see you again soon!\")","    return redirect(url_for('login'))","","","","","if __name__ == '__main__':","    app.run(host=os.environ.get('IP'),","        port=int(os.environ.get('PORT')))"],"id":319},{"start":{"row":0,"column":0},"end":{"row":254,"column":41},"action":"insert","lines":["import os","import re","from flask import Flask, render_template, redirect, request, url_for, session, flash","import json","from flask_pymongo import PyMongo","import pymongo","from pymongo import MongoClient","from bson.objectid import ObjectId"," ","","from werkzeug.security import generate_password_hash, check_password_hash","","","app = Flask(__name__)","","app.secret_key = \"randomstring123\"","","","","if app.config['DEBUG'] == True:","    from config import dbconfig","    app.config[\"MONGO_DBNAME\"] = 'dumpdinners'","    app.config[\"MONGO_URI\"] = dbconfig()","else:","    app.config['MONGO_URI'] = os.environ.get(\"MONGO_URI\")","    app.config['MONGO_DBNAME'] = os.environ.get(\"MONGO_DBNAME\")","","mongo = PyMongo(app)","","","@app.route('/')","@app.route('/index')","def index():","    \"\"\"Home page the gets 4 recipes from DB that have been viewed the most\"\"\"","    four_recipes = mongo.db.recipes.find().limit(4)","    return render_template('allrecipes1.html', recipes=four_recipes)     ","","@app.route('/allrecipes')","def allrecipes():","    recipes = mongo.db.recipes.find()","    return render_template('allrecipes.html', recipes=recipes)    ","    ","@app.route('/allrecipes1')","def allrecipes1():","    recipes = mongo.db.recipes.find()","    four_recipes = mongo.db.recipes.find().limit(4)","    return render_template('allrecipes1.html', recipes=four_recipes)        ","","@app.route('/add_recipe')","def add_recipe():","    recipes = mongo.db.recipes.find()","    return render_template('addrecipe.html',","        recipes=mongo.db.categories.find())   ","","    ","","@app.route('/insert_recipe', methods=['POST'])","def insert_recipe():","    recipes = mongo.db.recipes","    recipes.insert_one(request.form.to_dict())","    flash (\"Thank you, your recipe has been inserted!\")","    return render_template('recipe.html', recipe=recipe)","   ","         ","    ","    ","@app.route('/edit_recipe/<recipe_id>', methods=['GET', 'POST'])","def edit_recipe(recipe_id):","    \"\"\"Allows logged in user to edit their own recipes\"\"\"","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    all_categories =  mongo.db.categories.find()","    if request.method == 'GET':","        ","        return render_template('editrecipe.html', recipe=recipe_db, categories=all_categories)","   ","","# referred to this article for advice on 'views' - https://stackoverflow.com/questions/5782311/mongodb-inc-embedded-value-syntax","","@app.route('/update_recipe/<recipe_id>', methods=[\"POST\"])","def update_recipe(recipe_id):","    recipes = mongo.db.recipes","    recipes.update( {'_id': ObjectId(recipe_id)},","    {","        '$set': {","            ","        'recipe_name':request.form.get('recipe_name'),","        'ingredients':request.form.get('ingredients'),","        'image': request.form.get('image'),","        'category_name': request.form.get('category_name'),","        'username': request.form.get('username'),","        'methods': request.form.get('methods'),","        'short_description': request.form.get('short_description'),","        'date_added': request.form.get('date_added'),","        'is_vegetarian': request.form.get('is_vegetarian'),","        'views':1,","        'likes':1","        ","        }","    })","    return redirect(url_for('allrecipes'))","    ","","","","@app.route('/delete_recipe/<recipe_id>')","def delete_recipe(recipe_id):","    mongo.db.recipes.remove({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes'))","    ","@app.route('/search')","def search():","    \"\"\"Provides logic for search bar\"\"\"","    orig_query = request.args['query']","    # using regular expression setting option for any case","    query = {'$regex': re.compile('.*{}.*'.format(orig_query)), '$options': 'i'}","    # find instances of the entered word in title, tags or ingredients","    results = mongo.db.recipes.find({","        '$or': [","            {'recipe_name': query},","            {'ingredients': query},","            {'recipe_name': query}","        ]","    })","    return render_template('search.html', query=orig_query, results=results)","","","@app.route('/recipe/<recipe_id>')","def recipe(recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'views': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return render_template('recipe.html', recipe=recipe_db)","","# routing for likes","","@app.route('/likes/<recipe_id>')","def likes(recipe_id):","   ","    \"\"\"Shows full recipe and increments view\"\"\"","    mongo.db.recipes.find_one_and_update(","        {'_id': ObjectId(recipe_id)},","        { '$inc': { 'likes': 1}}","        ","        ","      ","    )","    recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","    return redirect(url_for('allrecipes1'))","","# # routing for shares","","# # @app.route('/shares1/<recipe_id>')","# # def shares1 (recipe_id):","   ","# #     \"\"\"Shows full recipe and increments view\"\"\"","# #     mongo.db.recipes.find_one_and_update(","# #         {'_id': ObjectId(recipe_id)},","# #         { '$inc': { 'shares1': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('allrecipes1'))","","# @app.route('/shares2/<recipe_id>')","# def shares2 (recipe_id):","   ","#     \"\"\"Shows full recipe and increments view\"\"\"","#     mongo.db.recipes.find_one_and_update(","#         {'_id': ObjectId(recipe_id)},","#         { '$inc': { 'shares2': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('allrecipes1'))","    ","# @app.route('/shares2/<recipe_id>')","# def shares2 (recipe_id):","   ","#     \"\"\"Shows full recipe and increments view\"\"\"","#     mongo.db.recipes.find_one_and_update(","#         {'_id': ObjectId(recipe_id)},","#         { '$inc': { 'shares2': 1}}","        ","        ","      ","#     )","#     recipe_db = mongo.db.recipes.find_one_or_404({'_id': ObjectId(recipe_id)})","#     return redirect(url_for('shares2'))","","      ","    ","#Copied routing for login from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","","@app.route('/login', methods=[\"GET\",\"POST\"])","def login():","    if request.method == 'POST':","        login_user = mongo.db.register.find_one({'username': request.form['username']})","        form = request.form","        if login_user:","            if(form[\"password\"] == login_user[\"password\"]): # if password correct","                session['username'] = login_user[\"username\"]","                return redirect(url_for('allrecipes',register_id = login_user[\"_id\"]))","            else: # and if password is not correct","               flash(\"Incorrect password, please try again or register\") ","        else:# if user does not exist","            flash(\"User does not exist\")","            return redirect(url_for('register'))","    return render_template('login.html')            ","    ","    ","#Copied routing for register from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","@app.route('/register', methods=['POST','GET'])","def register():","    if request.method == 'POST':","        register = mongo.db.register","        register_id = register.insert_one(request.form.to_dict())","        # print(register)","        object_id = register_id.inserted_id","        flash(\"Thank you for registering, please login to view more recipes and add your own!\")","        return redirect(url_for('login'))","    return render_template('register.html')","              ","    ",""," ","#Copied routing for allrecipeslist from Deborah Thompson, student at Code Institute for login routing - #https://github.com/debbiect246/recipe-app#","","","@app.route('/logout')","def logout():","    \"\"\"Clears session and redirects to home\"\"\"","    ","    session.clear()","    flash (\"Thank you, hope to see you again soon!\")","    return redirect(url_for('login'))","","","","","if __name__ == '__main__':","    app.run(host=os.environ.get('IP'),","        port=int(os.environ.get('PORT')))"]}]]},"ace":{"folds":[],"scrolltop":3563,"scrollleft":0,"selection":{"start":{"row":262,"column":23},"end":{"row":262,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":253,"state":"start","mode":"ace/mode/python"}},"timestamp":1564489700330,"hash":"ad5ef34bfb986671720a8d003d25e6d37c07beed"}